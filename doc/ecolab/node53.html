<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2017.2 (Released Jan 23, 2017) -->
<HTML>
<HEAD>
<TITLE>Using Classdesc: Method 2, building a library</TITLE>
<META NAME="description" CONTENT="Using Classdesc: Method 2, building a library">
<META NAME="keywords" CONTENT="ecolab">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2017.2">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ecolab.css">

<LINK REL="next" HREF="node54.html">
<LINK REL="previous" HREF="node52.html">
<LINK REL="up" HREF="node51.html">
<LINK REL="next" HREF="node54.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1082"
  HREF="node54.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1076"
  HREF="node51.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1070"
  HREF="node52.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1078"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1080"
  HREF="node143.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1083"
  HREF="node54.html">Synopsis of classdesc</A>
<B> Up:</B> <A NAME="tex2html1077"
  HREF="node51.html">Object Reflection</A>
<B> Previous:</B> <A NAME="tex2html1071"
  HREF="node52.html">Using Classdesc: Method 1,</A>
 &nbsp; <B>  <A NAME="tex2html1079"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1081"
  HREF="node143.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION000141200000000000000"></A><A NAME="library-method"></A>
<BR>
Using Classdesc: Method 2, building a
  library
</H3> 

<P>
For most purposes, generating inline <EM>action</EM> definitions suffices
for most purposes. However, if you have a lot of different classes for
which you need <EM>descriptors</EM> defined, then compile times may become
excessive. An alternative is to generate descriptor definition files for each
class, and compile these into a library. This is
achieved by the following rules:

<P>
<PRE>
.SUFFIXES: $(SUFFIXES) .h .cd .cdir .a
.h.cd:
        rm -rf $*.cdir 
        mkdir -p $*.cdir      
        classdesc -workdir $*.cdir -include ../$&lt; $(ACTIONS) &lt;$&lt; &gt;$@

.cd.a:
        $(MAKE) $(patsubst %.cc,%.o,$(wildcard $*.cdir/*.cc))
        ar r $@ $*.cdir/*.o
</PRE>

<P>
The <TT>-workdir</TT><A NAME="3392"></A> option requests <TT>classdesc</TT><A NAME="3394"></A> to write out the definition files into a
new directory (<code>$*.cdir</code> 
expands to <TT>foo.cdir</TT> in the foo
example). Function declarations are written out on standard output,
which in this case is redirected to <TT>foo.cd</TT>.

<P>
The <TT>-include</TT><A NAME="3398"></A> directive tells classdesc to insert
the line <code>#include "../foo.h"</code> into the definition files, so that
the definitions can be compiled.

<P>
The next (rather complicated) line compiles each of the definition
files. The reason for recursively calling make, rather than the compiler
directly, is that GNU Make is able to compile the directory in
parallel, reducing compilation times. 

<P>
See the polymorph example, which uses this technique.

<P>
<BR><HR>

</BODY>
</HTML>
