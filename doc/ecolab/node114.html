<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2017.2 (Released Jan 23, 2017) -->
<HTML>
<HEAD>
<TITLE>sparse_mat</TITLE>
<META NAME="description" CONTENT="sparse_mat">
<META NAME="keywords" CONTENT="ecolab">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2017.2">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ecolab.css">

<LINK REL="next" HREF="node115.html">
<LINK REL="previous" HREF="node112.html">
<LINK REL="up" HREF="node111.html">
<LINK REL="next" HREF="node115.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1967"
  HREF="node115.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1961"
  HREF="node111.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1955"
  HREF="node113.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1963"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1965"
  HREF="node143.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1968"
  HREF="node115.html">Global functions</A>
<B> Up:</B> <A NAME="tex2html1962"
  HREF="node111.html">arrays</A>
<B> Previous:</B> <A NAME="tex2html1956"
  HREF="node113.html">Array operators</A>
 &nbsp; <B>  <A NAME="tex2html1964"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1966"
  HREF="node143.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION000172000000000000000"></A><A NAME="sparse_mat"></A><A NAME="5321"></A>
<BR>
<TT>sparse_mat</TT>
</H2>

<P>
The <TT>sparse_mat</TT> data type is designed to hold the
interaction matrix <SPAN CLASS="MATH"></SPAN>, which is generally a sparse matrix. It is
built up of array&lt;double&gt; and iarray&lt;int&gt; components:

<P>
<PRE>
class sparse_mat
{
 public:
  array diag, val;
  iarray row, col;
  sparse_mat(int s=0, int o=0)
    {diag=array(s); val=array(o); row=iarray(o); col=iarray(o);}
  array operator*(iarray&amp; x);  /* matrix multiplication */
  sparse_mat operator=(sparse_mat x);
  void init_rand(int conn, double sigma);
};
</PRE>

<P>
<TT>diag</TT> stores the diagonal components of the array, <TT>val</TT> is
the packed list of offdiagonal values, with <TT>row</TT> and <TT>col</TT>
being the index lists. The only important operator defined for this
class is the matrix operation, which is defined as
<PRE>
beta*x == beta.diag*x + (beta.val*x[beta.col])[beta.row]
</PRE>
but is implemented separately for efficiency reasons.

<P>
<TT>init_rand</TT><A NAME="5332"></A> is a utility routine for randomly
initialising the nonzero pattern of the offdiagonal elements. The
average number of nonzeros per row is <TT>conn</TT>, and the standard
deviation of the number of nonzeros is <TT>sigma</TT>.

<P>
It is possible to represent the offdiagonal array differently  for
efficiency reasons. For example, if it is desired to represent the
offdiagonal elements as a dense 2D array, one can create an extra
pointer in the underlying implementation of array. Most of the time,
this pointer is NULL, but when the <code>cs_arrays</code> routine
<code>offmul</code> is called, it will check this pointer for the <TT>val</TT>
array. If it is NULL, it will create the efficient
representation, otherwise it will reuse the existing one. Because the
only way the array's actual value will get out of synch with the
efficient representation is by index assignment, <code>put_double()</code>
and <code>put_double_array</code> (as well as obviously
<code>delete_array()</code>) will need to be modified to deallocate the
efficient representation.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1967"
  HREF="node115.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1961"
  HREF="node111.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1955"
  HREF="node113.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1963"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1965"
  HREF="node143.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1968"
  HREF="node115.html">Global functions</A>
<B> Up:</B> <A NAME="tex2html1962"
  HREF="node111.html">arrays</A>
<B> Previous:</B> <A NAME="tex2html1956"
  HREF="node113.html">Array operators</A>
 &nbsp; <B>  <A NAME="tex2html1964"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1966"
  HREF="node143.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
