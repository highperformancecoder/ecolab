<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2017.2 (Released Jan 23, 2017) -->
<HTML>
<HEAD>
<TITLE>omap</TITLE>
<META NAME="description" CONTENT="omap">
<META NAME="keywords" CONTENT="ecolab">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2017.2">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ecolab.css">

<LINK REL="next" HREF="node101.html">
<LINK REL="previous" HREF="node98.html">
<LINK REL="up" HREF="node87.html">
<LINK REL="next" HREF="node100.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1748"
  HREF="node100.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1742"
  HREF="node87.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1736"
  HREF="node98.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1744"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1746"
  HREF="node143.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1749"
  HREF="node100.html">Note on using macros</A>
<B> Up:</B> <A NAME="tex2html1743"
  HREF="node87.html">Graphcode</A>
<B> Previous:</B> <A NAME="tex2html1737"
  HREF="node98.html">Ptrlist</A>
 &nbsp; <B>  <A NAME="tex2html1745"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1747"
  HREF="node143.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION000155000000000000000"></A><A NAME="4924"></A><A NAME="omap"></A>
<BR>
omap
</H2>

<P>
An omap is a container for storing <A HREF="node97.html#objref"
 NAME="4930"><EM>objrefs</EM></A>, indexed by ID.

<P>
<PRE>
  class omap: public MAP
  {
  public:
    objref&amp; operator[](GraphID_t i);
    omap&amp; operator=(omap&amp; x);
  };
</PRE>

<P>
There are a few different possible ways of implementing omaps, with
differing performance characteristics.  Graphcode provides two
different models, <EM>vmap</EM> and <EM>hmap</EM> that may be readily
deployed by the user, however users can fairly easily provide their
own implementation if desired. Different implementations can be
selected by defining the <code>MAP</code> macro<A NAME="4935"></A> to be the desired
omap implementation before including <code>graphcode.h</code>. This will
declare everything in the namespace
<code>graphcode_vmap</code><A NAME="4936"></A> or
<code>graphcode_hmap</code><A NAME="4937"></A> as appropriate. Using
this scheme, it is possible to have two different omap types in the
one object file, by including graphcode.h twice. However, if you do
this, you will need to <code>#undef GRAPHCODE_H</code> guard variable prior
to subsequent includes.

<P>
vmap is intended for use with contiguous GraphID ranges. If there are
holes in the identifier range, then the iterator will return invalid
references for these holes, and the size() method will be incorrect.

<P>
If you need to have non-contiguous ID ranges (perhaps for dynamic
graph management -- note this is not currently supported), then please
use the hmap<A NAME="4938"></A> implementation instead (which will have some performance
penalty).

<P>
MAP must provide the following members:
<PRE>
class MAP
{
  protected:
    objref&amp; at(GraphID_t i);
  public:
    MAP();
    MAP(const MAP&amp;)
    class iterator
     {
       iterator();
       iterator(const iterator&amp;);
       iterator&amp; operator=(const iterator&amp;); 
       iterator operator++(int);
       iterator operator++();
       iterator operator--(int);
       iterator operator--();
       bool operator==(const iterator&amp; x) const;
       bool operator!=(const iterator&amp; x) const;
       objref&amp; operator*();
       objref* operator-&gt;();
     };
    iterator begin();
    iterator end();
    unsigned size();
}
</PRE>

<P>
The <code>at</code><A NAME="4941"></A> method is essentially a replacement for <code>operator[]()</code>. A
simple example of an omap implementation is provided by <code>vmap</code><A NAME="4942"></A>:
<PRE>
class vmap: public std::vector&lt;objref&gt;
{
protected:
  objref&amp; at(GraphID_t i) 
  {
    if (i&gt;=size()) resize(i+1);
    return std::vector&lt;objref&gt;::operator[](i);
  }
};
</PRE>

<P>
hmap is a hash map implementation. With all hash maps, performance of
the map is critically dependent upon the choice of hash function, which
is application dependent. hmap is simply defined as:
<PRE>
class hmap: public hashmap&lt;simple_hash&gt; {};
</PRE>
You can provide your own omap definition (umap, say), with your own
user defined hash function in the following way:

<OL>
<LI>Create a file &ldquo;umap&rdquo; somewhere in the default search path with
  the following:
<PRE>
#include "hashmap.h"
struct myhash
{
  unsigned operator()(GraphID_t i) {...}
};
class umap: public hashmap&lt;myhash&gt; {};
</PRE>
</LI>
<LI>Add the new omap definitions to the Graphcode library:
<PRE>
make MAP=umap
</PRE>
</LI>
<LI>Include the declarations of the <code>graphcode_umap</code> namespace
  in your application source file:
<PRE>
#define MAP umap
#undef GRAPHCODE_H
#include &lt;graphcode.h&gt;
</PRE>
</LI>
</OL>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html1750"
  HREF="node100.html">Note on using macros to parametrise omap</A>
</UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1748"
  HREF="node100.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1742"
  HREF="node87.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1736"
  HREF="node98.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1744"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1746"
  HREF="node143.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1749"
  HREF="node100.html">Note on using macros</A>
<B> Up:</B> <A NAME="tex2html1743"
  HREF="node87.html">Graphcode</A>
<B> Previous:</B> <A NAME="tex2html1737"
  HREF="node98.html">Ptrlist</A>
 &nbsp; <B>  <A NAME="tex2html1745"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1747"
  HREF="node143.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
