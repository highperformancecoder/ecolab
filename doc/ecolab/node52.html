<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2017.2 (Released Jan 23, 2017) -->
<HTML>
<HEAD>
<TITLE>Using Classdesc: Method 1, inlining</TITLE>
<META NAME="description" CONTENT="Using Classdesc: Method 1, inlining">
<META NAME="keywords" CONTENT="ecolab">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2017.2">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ecolab.css">

<LINK REL="next" HREF="node53.html">
<LINK REL="previous" HREF="node51.html">
<LINK REL="up" HREF="node51.html">
<LINK REL="next" HREF="node53.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1068"
  HREF="node53.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1062"
  HREF="node51.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1056"
  HREF="node51.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1064"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1066"
  HREF="node143.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1069"
  HREF="node53.html">Using Classdesc: Method 2,</A>
<B> Up:</B> <A NAME="tex2html1063"
  HREF="node51.html">Object Reflection</A>
<B> Previous:</B> <A NAME="tex2html1057"
  HREF="node51.html">Object Reflection</A>
 &nbsp; <B>  <A NAME="tex2html1065"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1067"
  HREF="node143.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION000141100000000000000">
Using Classdesc: Method 1, inlining</A>
</H3>

<P>
The inlining method is conceptually the simplest, and practically the
easiest method to use. Start with the following rules in your <EM>GNU
  Make</EM> <TT>Makefile</TT>:
<PRE>
.SUFFIXES: .c .cc .o .d .h .cd
ACTIONS=pack unpack
OBJS= ...

include $(OBJS:.o=.d)

.c.d: 
        gcc $(CFLAGS) -w -MM $&lt; &gt;$@

.cc.d: 
        gcc $(CFLAGS) -w -MM -MG $&lt; &gt;$@

.h.cd:
        classdesc $(ACTIONS) &lt;$&lt; &gt;$@
</PRE> 

<P>
The rules ending in .d automatically generate Makefile dependency
rules for all the header files used in the project, and the <TT>  include</TT> introduces these rules into the Makefile. This feature is
not available with all <TT>make</TT>s, but is with <EM>GNU make</EM>. Since
it is a relatively trivial exercise to install GNU make if its not
already available, it makes sense to use the features of this tool.

<P>
The <TT>-MM</TT> option to gcc instructs the preprocessor to generate
Makefile dependency lines of the form:
<PRE>
xxx.o: yyy.h zzz.h
</PRE>
for all header files <TT>yyy.h, zzz.h</TT> included with the
<code>#include "..."</code> form, not the <code>#include &lt;...&gt;</code> form. This
is usually what one wants, rather than generating large numbers of
dependency lines for system headers that don't change. The <TT>-MG</TT>
option tells the compiler to assume that files it can't find will be
generated in the current directory. This is important, because we're
going to include .cd files, which are automatically generated by <TT>  classdesc</TT> by the .h.cd rule.
Some native compilers support similar automatic dependency generation,
however the behaviour differs in subtle ways from gcc. It is usually
simpler to rely on gcc being available, as with GNU make. Note that
gcc is not necessarily being used for code generation -- one can
still use the native compilers for that.

<P>
With these rules defined in the Makefile, all you need to do use a
statement of the form <code>buf &lt;&lt; foo;</code> is to place the statement 
<PRE>
#include "foo.cd"
#include &lt;classdesc_epilogue.h&gt;
</PRE>
somewhere after the <code>#include "foo.h"</code> line, including the
<TT>foo</TT> class definition. Any changes to the foo definition will
update everything automatically.

<P>
<B>It is mandatory that <code>classdesc_epilogue.h</code><A NAME="classdesc_epilogue"></A> is included, it is not
  an optional feature</B>. You will now get a link failure if you do not
included this file when needed:
<PRE>
undefined reference to `(anonymous namespace)::classdesc_epilogue_not_included()'
</PRE>
<A NAME="3383"></A>
<I CLASS="sans"><I CLASS="slanted">    Eco Lab</I></I> users should use the file
  <code>ecolab_epilogue.h</code> instead.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1068"
  HREF="node53.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1062"
  HREF="node51.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1056"
  HREF="node51.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1064"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1066"
  HREF="node143.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1069"
  HREF="node53.html">Using Classdesc: Method 2,</A>
<B> Up:</B> <A NAME="tex2html1063"
  HREF="node51.html">Object Reflection</A>
<B> Previous:</B> <A NAME="tex2html1057"
  HREF="node51.html">Object Reflection</A>
 &nbsp; <B>  <A NAME="tex2html1065"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1067"
  HREF="node143.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
