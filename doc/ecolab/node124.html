<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2017.2 (Released Jan 23, 2017) -->
<HTML>
<HEAD>
<TITLE>Statistical Analysis</TITLE>
<META NAME="description" CONTENT="Statistical Analysis">
<META NAME="keywords" CONTENT="ecolab">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2017.2">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ecolab.css">

<LINK REL="next" HREF="node125.html">
<LINK REL="previous" HREF="node121.html">
<LINK REL="up" HREF="ecolab.html">
<LINK REL="next" HREF="node125.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html2107"
  HREF="node125.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2101"
  HREF="ecolab.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2095"
  HREF="node123.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2103"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html2105"
  HREF="node143.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html2108"
  HREF="node125.html">random.cc</A>
<B> Up:</B> <A NAME="tex2html2102"
  HREF="ecolab.html">Eco Lab Documentation</A>
<B> Previous:</B> <A NAME="tex2html2096"
  HREF="node123.html">Reduction Functions</A>
 &nbsp; <B>  <A NAME="tex2html2104"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html2106"
  HREF="node143.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION000190000000000000000">
Statistical Analysis</A>
</H1>

<P>
The Analysis module contains some simple statistics support in the
form of a <A HREF="node83.html#TCLTYPE">TCL exported C++ data type</A>. The class definition is:

<P>
<PRE>
struct Stats: public array_ns::array&lt;float&gt;
{
  double sum, sumsq;
  float max, min;
  Stats(): sum(0), sumsq(0), max(-std::numeric_limits&lt;float&gt;::max()), 
           min(std::numeric_limits&lt;float&gt;::max()) {}

  void clear();
  double av();
  double median();
  double stddev();

  Stats&amp; operator&lt;&lt;=(float x);
  Stats&amp; operator&lt;&lt;=(const array_ns::array&lt;float&gt;&amp; x);
  Stats&amp; operator&lt;&lt;=(const array_ns::array&lt;double&gt;&amp; x);

  void add_data(TCL_args args); 
};

struct HistoStats: public Stats
{
  unsigned nbins;
  bool logbins;
  HistoStats(): nbins(100), logbins(false) {}
  array_ns::array&lt;double&gt; histogram();
  array_ns::array&lt;double&gt; bins();

  double loglikelihood(TCL_args args);

  array_ns::array&lt;double&gt; fitPowerLaw(); //&lt; fit x^{-a} - return a and x_min
  double fitExponential()                //&lt; fit exp(-x/a) - return a 
  array_ns::array&lt;double&gt; fitNormal();   //&lt; fit exp(-(x-m)^2/2s, return m, s
    
  array_ns::array&lt;double&gt; fitLogNormal(); //&lt; fit exp(-(log(x)-log m)^2/2s, return m, s
};
</PRE>

<P>
These classes can be used from the TCL programming environment like
this example:

<P>
<PRE>
HistoStats h


unuran rand
rand.set_gen {distr=pareto(.5,1.7);}

for {set i 0} {$i&lt;10000} {incr i} {
    h.add_data [rand.rand]
}

# obtain average, median, min, max, standard deviation and no. samples
puts stdout "[h.av] [h.median] [h.min] [h.max] [h.stddev] [h.size]"

# fit power law distribution, returning slope and xmin
puts stdout "[h.fitPowerLaw]"

# return log likelihood ratio for power law versus lognormal
array set pl [h.fitPowerLaw]
array set ln [h.fitLogNormal]
set R [h.loglikelihood powerlaw($pl(0),$pl(1)) 
                       lognormal($ln(0),$ln(1) $pl(1)]
puts stdout "R=$R p=[expr fabs([erfc $R])]"
</PRE>

<P>
Fitting parameters is achieved using the likelihood method as
described in [<A
 HREF="node142.html#Clauset-etal07">1</A>].

<P>
The log likelihood ratio function returns <!-- MATH
 ${\cal R}/\sqrt{2n}\sigma$
 -->
<SPAN CLASS="MATH"></SPAN>,
where <!-- MATH
 ${\cal R}=\ln \prod_i p_1(x_i)/p_2(x_i)$
 -->
<SPAN CLASS="MATH"></SPAN> is the logarithm of the
ratio of likelihoods for the two distributions <SPAN CLASS="MATH"></SPAN> and <SPAN CLASS="MATH"></SPAN>.

<P>
If the log likelihood ratio is positive, it means the <SPAN CLASS="MATH"></SPAN> is more
likely to fit the data than <SPAN CLASS="MATH"></SPAN>, and negative is the other way
around. <!-- MATH
 $p=|\mathrm{erfc}({\cal R})|$
 -->
<SPAN CLASS="MATH"></SPAN> is the probability that this conclusion
is wrong.[<A
 HREF="node142.html#Clauset-etal07">1</A>]

<P>
The histogram function allows one to do histograms without using the
GUI widget, which is useful for larger collections of data. The
parameters to the histogram method are the number of bins (default
100) and whether linear or logarithmic binning is used.
<BR><HR>

</BODY>
</HTML>
